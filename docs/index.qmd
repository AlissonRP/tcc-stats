---
title: "Implementação Computacional"
subtitle: "Do Modelo de Regressão Chen"
author: "<br> Alisson Rosa <br> <br> Orientadora: Prof. Laís Helen Loose"
title-slide-attributes:
  data-background-image: "https://img.freepik.com/vector-premium/fondo-abstracto-puntos-lineas-que-cruzan-colores-azul-claro_444390-6877.jpg?w=2000"
  data-background-opacity: "0.04"
format: 
    revealjs:
        theme: [serif, custom.scss]
        preview-links: auto
        chalkboard: true
        transition: fade
        controls: true
        logo: "imgs/ufsm.png"
        smaller: false
        bibliography: bib.bib
        nocite: |
                @*
lang: pt
---

## Introdução  {background-image="https://www.slidebackground.com/uploads/statistics-background/statistics-success-accounting-video-19.jpg" background-opacity=0.04}

::: {.incremental}
- Revisão Teórica

<br />

- Implementações Computacional

<br />

- Aplicações


:::


## Distribuição Chen {background-image="https://www.slidebackground.com/uploads/statistics-background/statistics-success-accounting-video-19.jpg" background-opacity=0.06}



\begin{align*}
F(y; \lambda,\delta)= 1 - \exp \left\lbrace   \delta \left[ 1-\exp(y^{\lambda}) \right] \right\rbrace 

\end{align*}


Por consequência a Função Quantilica fica dada por:

\begin{align}
\label{quant}
Q(\tau; \lambda , \delta)=\left\lbrace  \log\left[ 1 - \left( \frac{\log(1-\tau)}{\delta}\right) \right] \right\rbrace  ^{\frac{1}{\lambda}}, \quad 0<\tau<1.
\end{align}


em que $y>0$    
$\delta , \lambda > 0$ são os parâmetros de forma 




## Distribuição Chen {background-image="https://www.slidebackground.com/uploads/statistics-background/statistics-success-accounting-video-19.jpg" background-opacity=0.06}


::: {.incremental}


* Considera-se $\mu_{\tau}= Q(\tau; \lambda , \delta)$ representando o $\tau$-ésimo quantil da distribuição Chen e
* Supõe-se  que $\delta$ possa ser expresso como $$\delta=\dfrac{\log(1-\tau)}{1-\exp(\mu_{\tau}^{\lambda})}$$

* Então tem-se $$F(y; \lambda, \mu_{\tau}, \tau)= 1 - \exp \left\lbrace  \dfrac{\log(1-\tau)}{1-\exp(\mu_{\tau}^{\lambda})} [ 1-\exp(y^{\lambda})] \right\rbrace  , \quad  y > 0.$$

:::


## Modelo de Regressão 

CITAÇÃO 1 - GAJALARDO  

CITAÇÃO 2 - GUERRA RAMIREZ  

CITAÇÃO 3  SAULO









## Inferência - Quantidades Básicas

A função de log-verossimilhança fica dada por:
$$
\ell(\mathbf{\theta})=\sum\limits_{t=1}^{n}\ell_t(\mu_t,\lambda),
$$

$$
\ell_t(\mu_t,\lambda)=\log\prod_{i=1}^{n}\dfrac{dF(y; \lambda, \mu_{\tau}, \tau)}{dy}.
$$


## Inferência - Intervalos de Confiança

Seja $\theta_r, r= 1,2,\ldots,k + 2$, o $r$-ésimo componente do vetor de parâmetros $\mathbf{\theta}$. O intervalo de confiança assintótico de $100 (1- \alpha)\%$ para $\theta_r$ é dado por
\begin{align*}
\left[ \widehat{\theta}_r \pm z_{1-\alpha /2} \mbox{se}( \widehat{\theta}_r )\right] , \quad r=1,\ldots, k + 2,
\end{align*}



em que $z_{1-\alpha/2}$ é o quantil da distribuição normal padrão, tal que $P(Z<z_{1-\alpha/2})=1-\alpha/2$, com $Z$ variável aleatória com distribuição normal padrão  e $\text{se}(\widehat{\theta}_r)$ é o erro padrão assintótico de $\widehat{\theta}_r$


## Inferência - Teste de Hipótese


Agora, consideremos o interesse em testar as hipóteses
\begin{align*}
   H_0: \theta_r = \theta_r^0 \quad  versus \quad H_1: \theta_r \neq \theta_r^0,
\end{align*}
em que $\theta_r^0$ representa um valor específico para o parâmetro desconhecido $\theta_r$. Uma estatística comumente utilizada para testar essas hipóteses é a raiz quadrada da estatística de Wald, definida por
\begin{align*}
z=\frac{\widehat{\theta}_r - \theta_r^0}{\mbox{se}( \widehat{\theta}_r )}.
\end{align*}
 Sob $H_0$ e para $n$ grande, $z$ tem uma distribuição normal padrão. A hipótese nula é rejeitada para valores de $|z|$ maiores que o quantil $z_{1-\alpha/2}$


## Medidas de Diagnóstico

Para avaliar a adequação do ajuste do modelo em dados reais consideramos o resíduo quantílico, que  é definido como \citep{dunn1996}
\begin{align*}
 r_t= \Phi^{-1}\left\lbrace F (y_t; \widehat{\lambda}, \widehat{\mu}_t, \tau )\right\rbrace,
  \end{align*}
em que $\Phi(\cdot)$  é a função de distribuição acumulada da normal padrão e $F (y_t; \widehat{\lambda}, \widehat{\mu}_t, \tau )$ é a função de distribuição acumulada dada em \eqref{acumulada}. Se os parâmetros do modelo são estimados consistentemente, $r_t$  converge para uma distribuição normal padrão,  independente da distribuição da variável resposta.


## Medidas de Diagnóstico

O coeficiente de determinação generalizado proposto em \cite{Nagelkerke1991}, é uma medida global de qualidade do ajuste é dado por 
\vspace*{-0.3cm}
\begin{align*}
R^2= 1 - \exp\left[ - \frac{2}{n} \left[ \ell(\widehat{\bm{\theta}}) -\ell(\widehat{\bm{\theta}}_0) \right] \right],
\end{align*}
em que $\ell(\widehat{\bm{\theta}}_0)$ é a log-verossimilhança maximizada do modelo sem regressores (nulo) e a $\ell(\widehat{\bm{\theta}})$  é a log-verossimilhança maximizada do modelo ajustado. 


# O Pacote



![](imgs/Rep1.png){.absolute top=150 right=100 width="180" height="950"}

## Estrutura Básica

* Unidade Básica de código compartilhavel

* Simplificação

## Funções básicas

* `chen_reg`
* `rchen`
* `auto_chen`
* `best_chen`



##  `rchen` e `chen_reg`



##  `auto_chen` e `best_chen`

## Principais Métodos Genéricos

* summary
* plot
* residuals
* predict








## Interface Web (Shiny)

## {background-iframe="https://alissonrp.shinyapps.io/full_app/?_ga=2.83236885.2012925531.1652155237-1564274603.1652155237" background-interactive="true"}

# Aplicação

##


*  Os dados utilizados neste estudo são provenientes do Instituto Brasileiro de Geografia e Estatística (IBGE)
*  desenvolver um modelo de regressão quantílico Chen para prever quantis do PIB per capita do estado em referência ao PIB per capita do Brasil no ano de 2019

## Aplicação
*  Consideramos como variável resposta o PIB per capita do estado em referência ao PIB per capita do Brasil no ano de 2019 que chamaremos de PIB referencial, que é dado por
$$
Y = \dfrac{\text{PIB}_e}{\text{PIB}_{br}}
$$


## Aplicação


* IDHe: Índice de desenvolvimento humano educacional no ano de 2017 ($x_1$);
* Área: Área do estado considerado  em 2019 ($x_2$);
* Densidade demográfica: Densidade demográfica do estado considerado 2019 ($x_3$);
* Pobreza: Índice de pobreza do estado em questão em 2019 ($x_4$).


## Densidade


## Resumo do Ajuste


## Gráficos



# Considerações finais

## 

# Bibliografia
